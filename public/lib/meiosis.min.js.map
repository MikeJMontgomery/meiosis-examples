{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///meiosis.min.js","webpack:///webpack/bootstrap 7ed37e3bdea7c9f1051c","webpack:///./src/index.ts","webpack:///./src/meiosis.ts","webpack:///./src/wire.ts"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","__export","hasOwnProperty","newInstance","createComponent","config","actions","nextAction","initialModel","ready","receive","state","view","postRender","Error","allInitialModels","push","allStates","hasActions","propose","actionsOrPropose","allReceives","allReadies","allPostRenders","allNextActions","model","proposal","context","undefined","createRootWire","wire_1","defaultWireCreator","createComponentWire","rootWire","nextId","componentWire","emit","run","runConfig","rootModel","forEach","rootState","stateFunction","prevState","listen","i","length","received","renderRoot_","result","renderer","rootComponent","renderRoot","devtool","window","initialModel_1","copy","bufferedReceives_1","devtoolInitialized_1","postMessage","type","addEventListener","evt","data","_a","ts","obj","JSON","parse","stringify","instance","createWire","listener","lstnr","wireName","name","nextWireId","theWire","wires"],"mappings":"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","file":"meiosis.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"meiosis\"] = factory();\n\telse\n\t\troot[\"meiosis\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"meiosis\"] = factory();\n\telse\n\t\troot[\"meiosis\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tfunction __export(m) {\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t}\n\t__export(__webpack_require__(1));\n\t__export(__webpack_require__(2));\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar wire_1 = __webpack_require__(2);\n\tvar nextId = 1;\n\tvar copy = function (obj) { return JSON.parse(JSON.stringify(obj)); };\n\tfunction newInstance() {\n\t    var allInitialModels = [];\n\t    var allStates = [];\n\t    var allReceives = [];\n\t    var allReadies = [];\n\t    var allPostRenders = [];\n\t    var allNextActions = [];\n\t    var createRootWire = wire_1.defaultWireCreator();\n\t    var createComponentWire = wire_1.defaultWireCreator();\n\t    var rootWire = createRootWire(\"meiosis_\" + (nextId++));\n\t    var componentWire = createComponentWire();\n\t    var propose = componentWire.emit;\n\t    function createComponent(config) {\n\t        if (!config || (!config.actions &&\n\t            !config.nextAction &&\n\t            !config.initialModel &&\n\t            !config.ready &&\n\t            !config.receive &&\n\t            !config.state &&\n\t            !config.view &&\n\t            !config.postRender)) {\n\t            throw new Error(\"Please specify a config when calling createComponent.\");\n\t        }\n\t        var initialModel = config.initialModel;\n\t        if (initialModel) {\n\t            if (typeof initialModel !== \"function\") {\n\t                throw new Error(\"initialModel in createComponent must be a function. You can pass the root initialModel object to the run function.\");\n\t            }\n\t            allInitialModels.push(initialModel);\n\t        }\n\t        var state = config.state;\n\t        if (state) {\n\t            allStates.push(state);\n\t        }\n\t        var hasActions = !!config.actions;\n\t        var actions = hasActions ? config.actions(propose) : null;\n\t        var actionsOrPropose = hasActions ? actions : propose;\n\t        var receive = config.receive;\n\t        if (receive) {\n\t            allReceives.push(receive);\n\t        }\n\t        var ready = config.ready;\n\t        if (ready) {\n\t            allReadies.push(function () { return ready(actionsOrPropose); });\n\t        }\n\t        var postRender = config.postRender;\n\t        if (postRender) {\n\t            allPostRenders.push(postRender);\n\t        }\n\t        var nextAction = config.nextAction;\n\t        if (nextAction) {\n\t            allNextActions.push(function (model, proposal) {\n\t                var context = { model: model, proposal: proposal };\n\t                if (hasActions) {\n\t                    context.actions = actions;\n\t                }\n\t                else {\n\t                    context.propose = propose;\n\t                }\n\t                nextAction(context);\n\t            });\n\t        }\n\t        return function (state) {\n\t            return config.view ? config.view(state, actionsOrPropose) : undefined;\n\t        };\n\t    }\n\t    ;\n\t    var run = function (runConfig) {\n\t        var rootModel = runConfig.initialModel || {};\n\t        allInitialModels.forEach(function (initialModel) { return rootModel = initialModel(rootModel); });\n\t        var rootState = runConfig.state || (function (model) { return model; });\n\t        allStates.forEach(function (stateFunction) {\n\t            var prevState = rootState;\n\t            rootState = function (model, state) { return stateFunction(model, prevState(model)); };\n\t        });\n\t        componentWire.listen(function (proposal) {\n\t            for (var i = 0; i < allReceives.length; i++) {\n\t                var receive = allReceives[i];\n\t                var received = receive(rootModel, proposal);\n\t                rootModel = received;\n\t            }\n\t            ;\n\t            rootWire.emit(rootModel);\n\t            allNextActions.forEach(function (nextAction) { return nextAction(rootModel, proposal); });\n\t        });\n\t        var renderRoot_ = function (state) {\n\t            var result = runConfig.renderer(state, runConfig.rootComponent);\n\t            allPostRenders.forEach(function (postRender) { return postRender(state); });\n\t            return result;\n\t        };\n\t        renderRoot_.initialModel = rootModel;\n\t        renderRoot_.state = rootState;\n\t        var renderRoot = renderRoot_;\n\t        rootWire.listen(function (model) { return renderRoot(rootState(model)); });\n\t        rootWire.emit(rootModel);\n\t        allReadies.forEach(function (ready) { return ready(); });\n\t        var devtool = window && window[\"__MEIOSIS_TRACER_DEVTOOLS_GLOBAL_HOOK__\"];\n\t        if (devtool) {\n\t            var initialModel_1 = copy(rootModel);\n\t            var bufferedReceives_1 = [];\n\t            var devtoolInitialized_1 = false;\n\t            createComponent({\n\t                receive: function (model, proposal) {\n\t                    if (devtoolInitialized_1) {\n\t                        window.postMessage({ type: \"MEIOSIS_RECEIVE\", model: model, proposal: proposal }, \"*\");\n\t                    }\n\t                    else {\n\t                        bufferedReceives_1.push({ model: copy(model), proposal: proposal });\n\t                    }\n\t                    return model;\n\t                }\n\t            });\n\t            window.addEventListener(\"message\", function (evt) {\n\t                if (evt.data.type === \"MEIOSIS_RENDER_ROOT\") {\n\t                    renderRoot(evt.data.state);\n\t                }\n\t                else if (evt.data.type === \"MEIOSIS_REQUEST_INITIAL_MODEL\") {\n\t                    window.postMessage({ type: \"MEIOSIS_INITIAL_MODEL\", model: initialModel_1 }, \"*\");\n\t                    devtoolInitialized_1 = true;\n\t                    for (var i = 0; i < bufferedReceives_1.length; i++) {\n\t                        var _a = bufferedReceives_1[i], model = _a.model, proposal = _a.proposal;\n\t                        window.postMessage({ type: \"MEIOSIS_RECEIVE\", model: model, proposal: proposal }, \"*\");\n\t                    }\n\t                }\n\t                else if (evt.data.type === \"MEIOSIS_REQUEST_STATE\") {\n\t                    var state = renderRoot.state(evt.data.model);\n\t                    var ts = evt.data.ts;\n\t                    window.postMessage({ type: \"MEIOSIS_STATE\", state: state, ts: ts }, \"*\");\n\t                }\n\t            });\n\t        }\n\t        return renderRoot;\n\t    };\n\t    return {\n\t        createComponent: createComponent,\n\t        run: run\n\t    };\n\t}\n\texports.newInstance = newInstance;\n\tvar instance = newInstance();\n\tvar createComponent = instance.createComponent;\n\texports.createComponent = createComponent;\n\tvar run = instance.run;\n\texports.run = run;\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar wires = {};\n\tvar nextWireId = 1;\n\tfunction defaultWireCreator() {\n\t    var createWire = function () {\n\t        var listener = null;\n\t        var listen = function (lstnr) { return listener = lstnr; };\n\t        var emit = function (proposal) { return listener(proposal); };\n\t        return { emit: emit, listen: listen };\n\t    };\n\t    return function (wireName) {\n\t        var name = wireName;\n\t        if (!name) {\n\t            name = \"wire_\" + nextWireId;\n\t            nextWireId++;\n\t        }\n\t        var theWire = wires[name];\n\t        if (!theWire) {\n\t            theWire = createWire();\n\t            wires[name] = theWire;\n\t        }\n\t        return theWire;\n\t    };\n\t}\n\texports.defaultWireCreator = defaultWireCreator;\n\t;\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n// WEBPACK FOOTER //\n// meiosis.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7ed37e3bdea7c9f1051c","export * from \"./meiosis\";\nexport * from \"./actions\";\nexport * from \"./component\";\nexport * from \"./config\";\nexport * from \"./context\";\nexport * from \"./nextAction\";\nexport * from \"./postRender\";\nexport * from \"./ready\";\nexport * from \"./receive\";\nexport * from \"./renderer\";\nexport * from \"./state\";\nexport * from \"./view\";\nexport * from \"./wire\";\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","import { Component } from \"./component\";\nimport { Config, InitialModel } from \"./config\";\nimport { Context } from \"./context\";\nimport { NextAction, NextActionFromActions } from \"./nextAction\";\nimport { PostRender } from \"./postRender\";\nimport { Ready } from \"./ready\";\nimport { Receive } from \"./receive\";\nimport { Renderer } from \"./renderer\";\nimport { State } from \"./state\";\nimport { Emitter, Listener, WireCreator, Wire, defaultWireCreator } from \"./wire\";\n\nexport interface RenderRoot<M, S> {\n  (state: S): any;\n  initialModel: M;\n  state: State<M, S>;\n}\n\nexport interface RunConfig<M, S, V> {\n  renderer: Renderer<S, V>;\n  rootComponent: Component<S, V>;\n  initialModel?: M;\n  state?: State<M, S>;\n}\n\nexport interface Run<M, S, V> {\n  (runConfig: RunConfig<M, S, V>): RenderRoot<M, S>;\n}\n\nexport interface CreateComponent<M, S, V, P> {\n  <A>(config: Config<M, S, V, P, A>): Component<S, V>;\n}\n\nexport interface MeiosisApp<M, S, V, P> {\n  createComponent: CreateComponent<M, S, V, P>;\n  run: Run<M, S, V>;\n}\n\nlet nextId = 1;\n\nconst copy = (obj: any): any => JSON.parse(JSON.stringify(obj));\n\nfunction newInstance<M, S, V, P>(): MeiosisApp<M, S, V, P> {\n  let allInitialModels: Array<InitialModel<M>> = [];\n  let allStates: Array<State<M, S>> = [];\n  let allReceives: Array<Receive<M, P>> = [];\n  let allReadies: Array<Ready<P, any>> = [];\n  let allPostRenders: Array<PostRender<S>> = [];\n  let allNextActions: Array<NextActionFromActions<M, P>> = [];\n\n  const createRootWire: WireCreator<M> = defaultWireCreator();\n  const createComponentWire: WireCreator<P> = defaultWireCreator();\n  const rootWire: Wire<M> = createRootWire(\"meiosis_\" + (nextId++));\n  const componentWire: Wire<P> = createComponentWire();\n  const propose: Emitter<P> = componentWire.emit;\n\n  function createComponent<A>(config: Config<M, S, V, P, A>): Component<S, V> {\n    if (!config || (\n      !config.actions &&\n      !config.nextAction &&\n      !config.initialModel &&\n      !config.ready &&\n      !config.receive &&\n      !config.state &&\n      !config.view &&\n      !config.postRender\n    )) {\n      throw new Error(\"Please specify a config when calling createComponent.\");\n    }\n    const initialModel: InitialModel<M> = config.initialModel;\n\n    if (initialModel) {\n      if (typeof initialModel !== \"function\") {\n        throw new Error(\"initialModel in createComponent must be a function. You can pass the root initialModel object to the run function.\");\n      }\n      allInitialModels.push(initialModel);\n    }\n\n    const state: State<M, S> = config.state;\n    if (state) {\n      allStates.push(state);\n    }\n\n    const hasActions: boolean = !!config.actions;\n    const actions: A = hasActions ? config.actions(propose) : null;\n    const actionsOrPropose: A | Emitter<P> = hasActions ? actions : propose;\n\n    const receive: Receive<M, P> = config.receive;\n    if (receive) {\n      allReceives.push(receive);\n    }\n\n    const ready: Ready<P, A> = config.ready;\n    if (ready) {\n      allReadies.push(() => ready(actionsOrPropose));\n    }\n\n    const postRender: PostRender<S> = config.postRender;\n    if (postRender) {\n      allPostRenders.push(postRender);\n    }\n\n    const nextAction: NextAction<M, P, A> = config.nextAction;\n    if (nextAction) {\n      allNextActions.push((model: M, proposal: P) => {\n        const context: Context<M, P, A> = { model, proposal };\n        if (hasActions) {\n          context.actions = actions;\n        }\n        else {\n          context.propose = propose;\n        }\n        nextAction(context);\n      });\n    }\n\n    return function(state: S): V {\n      return config.view ? config.view(state, actionsOrPropose) : undefined;\n    };\n  };\n\n  const run: Run<M, S, V> = (runConfig: RunConfig<M, S, V>): RenderRoot<M, S> => {\n    let rootModel: any = runConfig.initialModel || {};\n    allInitialModels.forEach((initialModel: Function) => rootModel = initialModel(rootModel));\n\n    let rootState: State<any, any> = runConfig.state || ( (model: M) => model );\n    allStates.forEach((stateFunction: State<M, S>) => {\n      const prevState = rootState;\n      rootState = (model: M, state: S): S => stateFunction(model, prevState(model))\n    });\n\n    componentWire.listen((proposal: any) => {\n      for (let i: number = 0; i < allReceives.length; i++) {\n        const receive: Receive<M, P> = allReceives[i];\n        const received: M = receive(rootModel, proposal);\n\n        rootModel = received;\n      };\n\n      rootWire.emit(rootModel);\n      allNextActions.forEach((nextAction: NextActionFromActions<M, P>) => nextAction(rootModel, proposal));\n    });\n\n    const renderRoot_: any = (state: S) => {\n      const result: any = runConfig.renderer(state, runConfig.rootComponent);\n      allPostRenders.forEach((postRender: PostRender<S>) => postRender(state));\n      return result;\n    };\n    renderRoot_.initialModel = rootModel;\n    renderRoot_.state = rootState;\n\n    const renderRoot: RenderRoot<M, S> = renderRoot_;\n\n    rootWire.listen((model: M) => renderRoot(rootState(model)));\n\n    rootWire.emit(rootModel);\n    allReadies.forEach((ready: Function) => ready());\n\n    const devtool: any = window && window[\"__MEIOSIS_TRACER_DEVTOOLS_GLOBAL_HOOK__\"];\n    if (devtool) {\n      const initialModel = copy(rootModel);\n      const bufferedReceives: Array<any> = [];\n      let devtoolInitialized: boolean = false;\n\n      createComponent({\n        receive: (model: any, proposal: any) => {\n          if (devtoolInitialized) {\n            window.postMessage({ type: \"MEIOSIS_RECEIVE\", model, proposal }, \"*\");\n          }\n          else {\n            bufferedReceives.push({model: copy(model), proposal});\n          }\n          return model;\n        }\n      });\n      window.addEventListener(\"message\", evt => {\n        if (evt.data.type === \"MEIOSIS_RENDER_ROOT\") {\n          renderRoot(evt.data.state);\n        }\n        else if (evt.data.type === \"MEIOSIS_REQUEST_INITIAL_MODEL\") {\n          window.postMessage({ type: \"MEIOSIS_INITIAL_MODEL\", model: initialModel }, \"*\");\n          devtoolInitialized = true;\n\n          for (let i: number = 0; i < bufferedReceives.length; i++) {\n            const { model, proposal }: any = bufferedReceives[i];\n            window.postMessage({ type: \"MEIOSIS_RECEIVE\", model, proposal }, \"*\");\n          }\n        }\n        else if (evt.data.type === \"MEIOSIS_REQUEST_STATE\") {\n          const state: S = renderRoot.state(evt.data.model);\n          const ts: string = evt.data.ts;\n          window.postMessage({ type: \"MEIOSIS_STATE\", state, ts }, \"*\");\n        }\n      });\n    }\n\n    return renderRoot;\n  };\n\n  return {\n    createComponent,\n    run\n  };\n}\n\nconst instance = newInstance<any, any, any, any>();\nconst createComponent = instance.createComponent;\nconst run = instance.run;\n\nexport {\n  newInstance,\n  createComponent,\n  run\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/meiosis.ts","export interface Listener<P> {\n  (proposal: P): void;\n}\n\nexport interface Emitter<P> {\n  (proposal: P): void;\n}\n\nexport interface Wire<P> {\n  emit: Emitter<P>;\n  listen(listener: Listener<P>): any;\n}\n\nexport interface WireCreator<P> {\n  (wireName?: string): Wire<P>;\n}\n\nlet wires = {};\nlet nextWireId = 1;\n\nexport function defaultWireCreator<P>(): WireCreator<P> {\n  const createWire = function(): Wire<P> {\n    let listener: Listener<P> = null;\n    const listen = (lstnr: Listener<P>) => listener = lstnr;\n    const emit = (proposal: P) => listener(proposal);\n\n    return { emit, listen };\n  };\n\n  return function(wireName: string) {\n    let name = wireName;\n\n    if (!name) {\n      name = \"wire_\" + nextWireId;\n      nextWireId++;\n    }\n\n    let theWire: Wire<P> = wires[name];\n\n    if (!theWire) {\n      theWire = createWire();\n      wires[name] = theWire;\n    }\n\n    return theWire;\n  };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/wire.ts"],"sourceRoot":""}