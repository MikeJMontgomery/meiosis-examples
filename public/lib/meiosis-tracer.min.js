!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.meiosisTracer=t():e.meiosisTracer=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.meiosisTracer=void 0;var n=r(2),a=r(4),i=r(3);window.__MEIOSIS_TRACER_GLOBAL_HOOK__=!0;var o=function(e){var t=e.selector,r=e.renderModel,o=e.horizontal,d=(0,i.createReceiveValues)(n.tracerModel,a.tracerView);r=r||function(e,t){return window.postMessage({type:"MEIOSIS_RENDER_MODEL",model:e,sendValuesBack:t},"*")},(0,a.initialView)(t,n.tracerModel,r,o);var c=function(e,t){return window.postMessage({type:"MEIOSIS_TRIGGER_STREAM_VALUE",streamId:e,value:t},"*")};return window.addEventListener("message",function(e){if("MEIOSIS_VALUES"===e.data.type)d(e.data.values,e.data.update);else if("MEIOSIS_STREAM_IDS"===e.data.type){var t=e.data.streamIds;t.forEach(function(e){return n.tracerModel.streams[e]={index:0,values:[]}}),(0,a.initStreamIds)(t,n.tracerModel.streams,c)}else if("MEIOSIS_STREAM_VALUE"===e.data.type){var r=e.data.streamId,i=n.tracerModel.streams[r];i.values.push(e.data.value),i.index=i.values.length-1,(0,a.updateStreamValue)(r,i)}}),window.postMessage({type:"MEIOSIS_TRACER_INIT"},"*"),{receiveValues:d,reset:function(){return(0,a.reset)(n.tracerModel)}}};t.meiosisTracer=o},function(e,t,r){"use strict";var n=r(0);e.exports=n.meiosisTracer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={tracerStates:[],tracerIndex:0,streams:{}};t.tracerModel=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){return function(r,n){n&&(e.tracerStates.push(r),e.tracerIndex=e.tracerStates.length-1),t(r,e)}};t.createReceiveValues=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateStreamValue=t.initStreamIds=t.reset=t.tracerView=t.initialView=void 0;var n=r(5),a=function(e){return e&&e.__esModule?e:{default:e}}(n),i={type:"space",size:2},o=null,d=null,c=function(e,t){var r=document.getElementById("tracerSlider");if(r.setAttribute("max",String(t.tracerStates.length-1)),r.value=String(t.tracerIndex),document.getElementById("tracerIndex").innerHTML=String(t.tracerIndex),document.getElementById("tracerModel").value=(0,a.default)(e[0].value,i),0===document.querySelectorAll("div.dataStream").length){for(var n="",o=1,d=e.length;o<d;o++)n+="<div class='dataStream'><textarea rows='5' cols='40'></textarea></div>";document.getElementById("dataStreamContainer").innerHTML=n}var c=document.querySelectorAll("div.stream textarea");for(o=1,d=e.length;o<d;o++)c[o-1].value=(0,a.default)(e[o].value,i)},s=function(e,t){return function(r){var n=parseInt(r.target.value,10),a=t.tracerStates[n];t.tracerIndex=n;var i=a[0].value;e(i,!1),c(a,t)}},u=function(e,t){return function(r){var n=e[t],a=parseInt(r.target.value,10);n.index=a,S(t,n)}},l=function(e,t,r){return function(){try{var n=JSON.parse(t.value);r(e,n),o.style.display="none"}catch(e){o.style.display="block"}}},v=function(e){return function(t){try{var r=JSON.parse(t.target.value);e(r,!0),o.style.display="none"}catch(e){o.style.display="block"}}},f=function(e){return function(t){var r=t.target;"none"===e.style.display?(e.style.display="block",r.innerHTML="Hide"):(e.style.display="none",r.innerHTML="Show")}},m=function(e){return function(){p(e)}},p=function(e){var t=e.tracerStates[e.tracerStates.length-1];e.tracerStates.length=1,e.tracerStates[0]=t,e.tracerIndex=0,c(t,e)},g=function(e,t,r,n){var a=document.querySelector(e);if(a){d=n?" style='float: left'":"";var i="<div style='text-align: right'><button id='tracerToggle'>Hide</button></div><div id='tracerContainer'><div style='text-align: right'><button id='tracerReset'>Reset</button></div><div>Data streams:</div><input id='tracerSlider' type='range' min='0' max='"+String(t.tracerStates.length-1)+"' value='"+String(t.tracerIndex)+"' style='width: 100%'/><div id='tracerIndex'>"+String(t.tracerIndex)+"</div><div"+d+"><div>Model: (you can type into this box)</div><textarea id='tracerModel' rows='5' cols='40'></textarea><div id='errorMessage' style='display: none'><span style='color:red'>Invalid JSON</span></div></div><span id='dataStreamContainer'></span><span id='otherStreamContainer'></span></div>";a.innerHTML=i;var c=document.getElementById("tracerContainer");o=document.getElementById("errorMessage"),document.getElementById("tracerSlider").addEventListener("input",s(r,t)),document.getElementById("tracerModel").addEventListener("keyup",v(r)),document.getElementById("tracerToggle").addEventListener("click",f(c)),document.getElementById("tracerReset").addEventListener("click",m(t))}},y=function(e,t,r){var n="<div>Other streams:</div>";e.forEach(function(e){return n+="<div class='otherStream' id='"+e+"'><input type='range' min='0' max='0' value='0' style='width: 100%'/><div>0</div><textarea rows='5' cols='40'></textarea><div><button>Trigger</button></div></div>"}),document.getElementById("otherStreamContainer").innerHTML=n,e.forEach(function(e){var n=document.getElementById(e);n.getElementsByTagName("input")[0].addEventListener("input",u(t,e));var a=n.getElementsByTagName("button")[0],i=n.getElementsByTagName("textarea")[0];a.addEventListener("click",l(e,i,r))})},S=function(e,t){var r=document.getElementById(e),n=r.getElementsByTagName("textarea")[0],o=r.getElementsByTagName("input")[0],d=r.getElementsByTagName("div")[0];n.value=(0,a.default)(t.values[t.index],i),o.setAttribute("max",String(t.values.length-1)),o.value=String(t.index),d.innerHTML=String(t.index)};t.initialView=g,t.tracerView=c,t.reset=p,t.initStreamIds=y,t.updateStreamValue=S},function(e,t){function r(e,t){n=[];var r="",a=0;e=e.replace(/\\./g,o).replace(/(".*?"|'.*?')/g,o).replace(/\s+/,"");for(var i=0;i<e.length;i++){var s=e.charAt(i);switch(s){case"{":case"[":r+=s+"\n"+c(++a,t);break;case"}":case"]":r+="\n"+c(--a,t)+s;break;case",":r+=",\n"+c(a,t);break;case":":r+=": ";break;default:r+=s}}return r=r.replace(/\[[\d,\s]+?\]/g,function(e){return e.replace(/\s/g,"")}).replace(/\\(\d+)\\/g,d).replace(/\\(\d+)\\/g,d)}var n=[],a={tab:{char:"\t",size:1},space:{char:" ",size:4}},i={type:"tab"},o=function(e){return"\\"+n.push(e)+"\\"},d=function(e,t){return n[t-1]},c=function(e,t){return new Array(e+1).join(t)};e.exports=function(e,t){t=t||i;var n=a[t.type];if(null==n)throw new Error('Unrecognized indent type: "'+t.type+'"');var o=new Array((t.size||n.size)+1).join(n.char);return r(JSON.stringify(e),o)}}])});